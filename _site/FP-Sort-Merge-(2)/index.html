<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title> 정렬/합병 [ Part 2 ] </title>
    <meta name="description" content="  합병 단계  m-원 합병 (m-way merge)  6개의 런에 대한 2-원 합병  6개의 런에 대한 3-원 합병  균형 합병 (Balanced Merge)  12개의 런에 대한 2-원 균형 합병  다단계 합병 (Polyphase Merge)  2-원 다단계 합병의 예  5개 ...">

    <meta property="og:image" content="http://localhost:4000/assets/img/logo.png"/>

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://localhost:4000/FP-Sort-Merge-(2)/">
    <link rel="alternate" type="application/rss+xml" title="Gid Blog" href="http://localhost:4000/feed.xml ">





</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">Gid Blog</a>
        <small>BE Developer</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-heart"></i>About
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" post>
    <div class="left">
        <h1> 정렬/합병 [ Part 2 ] </h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i>2018-04-17
            </div>

            <div class="label-card">
                <i class="fa fa-user"></i>goodGid
                
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#파일처리" title="Category: 파일처리" rel="category">파일처리</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

            <div class="label-card">
            
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <!--a href="/tag/#%ED%8C%8C%EC%9D%BC%EC%B2%98%EB%A6%AC" title="Tag: 파일처리" rel="tag">파일처리</a-->
        <a href="/tag/#파일처리" title="Tag: 파일처리" rel="tag">파일처리</a>
    
  

</span>

            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
        <ul id="markdown-toc">
  <li><a href="#합병-단계" id="markdown-toc-합병-단계">합병 단계</a></li>
  <li><a href="#m-원-합병-m-way-merge" id="markdown-toc-m-원-합병-m-way-merge">m-원 합병 (m-way merge)</a></li>
  <li><a href="#6개의-런에-대한-2-원-합병" id="markdown-toc-6개의-런에-대한-2-원-합병">6개의 런에 대한 2-원 합병</a></li>
  <li><a href="#6개의-런에-대한-3-원-합병" id="markdown-toc-6개의-런에-대한-3-원-합병">6개의 런에 대한 3-원 합병</a></li>
  <li><a href="#균형-합병-balanced-merge" id="markdown-toc-균형-합병-balanced-merge">균형 합병 (Balanced Merge)</a></li>
  <li><a href="#12개의-런에-대한-2-원-균형-합병" id="markdown-toc-12개의-런에-대한-2-원-균형-합병">12개의 런에 대한 2-원 균형 합병</a></li>
  <li><a href="#다단계-합병-polyphase-merge" id="markdown-toc-다단계-합병-polyphase-merge">다단계 합병 (Polyphase Merge)</a></li>
  <li><a href="#2-원-다단계-합병의-예" id="markdown-toc-2-원-다단계-합병의-예">2-원 다단계 합병의 예</a></li>
  <li><a href="#5개-런의-2-원-다단계-합병에서-런-수의-변화" id="markdown-toc-5개-런의-2-원-다단계-합병에서-런-수의-변화">5개 런의 2-원 다단계 합병에서 런 수의 변화</a></li>
  <li><a href="#선택-트리-selection-tree-1" id="markdown-toc-선택-트리-selection-tree-1">선택 트리 (Selection Tree) (1)</a></li>
  <li><a href="#선택-트리-2" id="markdown-toc-선택-트리-2">선택 트리 (2)</a></li>
  <li><a href="#선택-트리-3" id="markdown-toc-선택-트리-3">선택 트리 (3)</a></li>
  <li><a href="#선택-트리-4" id="markdown-toc-선택-트리-4">선택 트리 (4)</a></li>
  <li><a href="#선택-트리-5" id="markdown-toc-선택-트리-5">선택 트리 (5)</a></li>
  <li><a href="#선택-트리-6" id="markdown-toc-선택-트리-6">선택 트리 (6)</a></li>
</ul>

<h1 id="합병-단계">합병 단계</h1>

<ul>
  <li>합병 수행 방법
    <ul>
      <li>m-원 합병 (m-way merge)</li>
      <li>균형 합병 (balanced merge)</li>
      <li>다단계 합병 (polyphase merge)</li>
    </ul>
  </li>
</ul>

<hr />

<h1 id="m-원-합병-m-way-merge">m-원 합병 (m-way merge)</h1>

<ul>
  <li>특징
    <ul>
      <li>m개(합병의 원 수)의 입력 파일을 동시에 처리하는 합병</li>
      <li>입력 파일 <code class="highlighter-rouge">m</code>개, 출력 파일 <code class="highlighter-rouge">1</code>개 : <code class="highlighter-rouge">m+1</code>개의 파일을 사용</li>
      <li>많은 입출력 : 한 패스에 합병이 끝나지 않으면 런들을 다시 분배하기 위해 복사,이동해야함</li>
      <li>이상적 정렬/합병 : m개의 런에 m개의 입력 파일 사용하여 한번의 m-원 합병을 적용</li>
    </ul>
  </li>
  <li>2-원 합병의 경우
    <ul>
      <li>한번 패스 후 : 합병된 <code class="highlighter-rouge">런의 크기</code>는 <code class="highlighter-rouge">2배</code>, <code class="highlighter-rouge">런의 수</code>는 <code class="highlighter-rouge">1/2배</code></li>
      <li>N개의 런으로 분할된 파일 정렬 위한 패스 수 : LogN</li>
    </ul>
  </li>
</ul>

<hr />

<h1 id="6개의-런에-대한-2-원-합병">6개의 런에 대한 2-원 합병</h1>

<figure>
    
    <a href="/assets/img/file_processing/sort_merge_2_1.png"><img src="/assets/img/file_processing/sort_merge_2_1.png" alt="" /></a>
    
    <figcaption> </figcaption>
</figure>

<hr />

<h1 id="6개의-런에-대한-3-원-합병">6개의 런에 대한 3-원 합병</h1>

<figure>
    
    <a href="/assets/img/file_processing/sort_merge_2_2.png"><img src="/assets/img/file_processing/sort_merge_2_2.png" alt="" /></a>
    
    <figcaption> </figcaption>
</figure>

<hr />

<h1 id="균형-합병-balanced-merge">균형 합병 (Balanced Merge)</h1>

<ul>
  <li>m-원 합병의 단점
    <ul>
      <li>파일의 재분배 : 많은 I/O 필요</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">균형 합병</code>
    <ul>
      <li>출력할 때, 미리 다음 단계에 사용할 입력 파일로 재분배 <br /> 즉, 출력 파일을 다음 단계의 입력 파일로 직접 사용
        <ul>
          <li>m-원 합병 : <code class="highlighter-rouge">m+1</code>개의 파일 필요</li>
          <li>m-원 균형합병 : <code class="highlighter-rouge">2m</code>개의 파일 필요 (m개 입력파일, m개 출력파일)</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>각 합병 단계 후
    <ul>
      <li>런의 총수는 합병 차수로 나눈만큼 감소</li>
      <li>런의 길이는 합병 차수배씩 증가</li>
      <li>초기 런의 수가 N일 때 합병 패스 수는 O(logm N)</li>
      <li>패스 수는 Same, 재분배를 Down</li>
    </ul>
  </li>
</ul>

<hr />

<h1 id="12개의-런에-대한-2-원-균형-합병">12개의 런에 대한 2-원 균형 합병</h1>

<figure class="half">
    
    <a href="/assets/img/file_processing/sort_merge_2_3.png"><img src="/assets/img/file_processing/sort_merge_2_3.png" alt="" /></a>
    
    <a href="/assets/img/file_processing/sort_merge_2_4.png"><img src="/assets/img/file_processing/sort_merge_2_4.png" alt="" /></a>
    
    <figcaption> </figcaption>
</figure>

<hr />

<h1 id="다단계-합병-polyphase-merge">다단계 합병 (Polyphase Merge)</h1>

<ul>
  <li>m-원 균형 합병 기법의 <code class="highlighter-rouge">단점</code>
    <ul>
      <li><code class="highlighter-rouge">2m</code>개 파일 필요 (m개 입력파일, m개 출력파일)</li>
    </ul>
  </li>
  <li>m-원 다단계 합병
    <ul>
      <li><code class="highlighter-rouge">m</code>개의 <code class="highlighter-rouge">입력 파일</code>과 <code class="highlighter-rouge">1</code>개의 <code class="highlighter-rouge">출력 파일</code></li>
      <li>입/출력 파일 수가 같지 않음 : <code class="highlighter-rouge">불균형</code> 합병</li>
      <li>파일의 <code class="highlighter-rouge">재분배</code>가 <code class="highlighter-rouge">필요 없고</code>, 파일 수는 <code class="highlighter-rouge">2m</code>에서 <code class="highlighter-rouge">m+1</code>로 감소</li>
      <li>각 합병 단계(pass)에서
        <ul>
          <li>입력 파일의 어느 하나가 공백이 될 때까지 런들을 합병</li>
          <li>공백이 된 <code class="highlighter-rouge">입력 파일</code>이 <code class="highlighter-rouge">다음 합병 단계</code>의 <code class="highlighter-rouge">출력 파일</code>이 됨</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<hr />

<h1 id="2-원-다단계-합병의-예">2-원 다단계 합병의 예</h1>

<figure class="half">
    
    <a href="/assets/img/file_processing/sort_merge_2_5.png"><img src="/assets/img/file_processing/sort_merge_2_5.png" alt="" /></a>
    
    <a href="/assets/img/file_processing/sort_merge_2_6.png"><img src="/assets/img/file_processing/sort_merge_2_6.png" alt="" /></a>
    
    <figcaption> </figcaption>
</figure>

<hr />

<h1 id="5개-런의-2-원-다단계-합병에서-런-수의-변화">5개 런의 2-원 다단계 합병에서 런 수의 변화</h1>

<figure>
    
    <a href="/assets/img/file_processing/sort_merge_2_7.png"><img src="/assets/img/file_processing/sort_merge_2_7.png" alt="" /></a>
    
    <figcaption> </figcaption>
</figure>

<hr />

<h1 id="선택-트리-selection-tree-1">선택 트리 (Selection Tree) (1)</h1>

<ul>
  <li>m개의 런을 하나의 큰 런으로 정렬
    <ul>
      <li>m개의 런 중 가장 작은 키 값의 레코드를 계속 선택, 출력</li>
      <li><code class="highlighter-rouge">선택 트리</code>를 사용하여 <code class="highlighter-rouge">비교 횟수</code>를 줄일 수 있음</li>
    </ul>
  </li>
  <li>선택 트리의 종류
    <ol>
      <li>승자 트리 (winner tree)</li>
      <li>패자 트리 (loser tree)</li>
    </ol>
  </li>
</ul>

<hr />

<h1 id="선택-트리-2">선택 트리 (2)</h1>

<ul>
  <li>승자 트리
    <ul>
      <li>완전 이진 트리</li>
      <li>각 단말 노드는 각 런의 최소 키 값 원소를 나타냄</li>
      <li>내부 노드는 그의 <code class="highlighter-rouge">두 자식 중</code>에서 <code class="highlighter-rouge">작은 키</code> 값을 가진 원소를 나타냄</li>
      <li>런이 8개인 경우 승자 트리 예</li>
    </ul>
  </li>
  <li>승자 트리 구축 과정
    <ul>
      <li>가장 <code class="highlighter-rouge">작은 키</code> 값을 가진 원소가 승자로 올라가는 토너먼트 경기로 표현</li>
      <li>트리의 각 내부 노드 : <br /> 두 자식 노드 원소의 토너먼트 승자</li>
      <li>루트 노드 : <br /> 전체 토너먼트 승자, 트리에서 가장 작은 키 값 가진 원소</li>
    </ul>
  </li>
</ul>

<figure>
    
    <a href="/assets/img/file_processing/sort_merge_2_8.png"><img src="/assets/img/file_processing/sort_merge_2_8.png" alt="" /></a>
    
    <figcaption> </figcaption>
</figure>

<hr />

<h1 id="선택-트리-3">선택 트리 (3)</h1>

<ul>
  <li>합병의 진행
    <ul>
      <li>루트가 결정되는 대로 순서순차에 출력 (7)</li>
      <li>다음 원소 <br /> 즉 런 4의 키 값이 13인 원소가 승자트리 노드[11]로 들어감</li>
      <li>승자 트리를 다시 재구성 : <br /> 노드 11에서부터 루트까지의 경로를 따라가면서 형제 노드 간 토너먼트 진행</li>
    </ul>
  </li>
</ul>

<figure>
    
    <a href="/assets/img/file_processing/sort_merge_2_9.png"><img src="/assets/img/file_processing/sort_merge_2_9.png" alt="" /></a>
    
    <figcaption> </figcaption>
</figure>

<hr />

<h1 id="선택-트리-4">선택 트리 (4)</h1>

<figure>
    
    <a href="/assets/img/file_processing/sort_merge_2_10.png"><img src="/assets/img/file_processing/sort_merge_2_10.png" alt="" /></a>
    
    <figcaption> </figcaption>
</figure>

<hr />

<h1 id="선택-트리-5">선택 트리 (5)</h1>

<ul>
  <li>패자 트리 (Loser tree)
    <ul>
      <li>루트 위에 0번 노드가 추가된 <code class="highlighter-rouge">완전 이진 트리</code></li>
    </ul>
  </li>
  <li>패자 트리 구축 과정
    <ul>
      <li>단말 노드 : 각 런의 최소 키값 원소</li>
      <li>내부 노드
        <ul>
          <li>두 자식 노드들이 부모노드에서 토너먼트 경기를 수행</li>
          <li><code class="highlighter-rouge">패자</code>는 <code class="highlighter-rouge">부모 노드</code>에 남음</li>
          <li><code class="highlighter-rouge">승자</code>는 <code class="highlighter-rouge">그 위</code> 부모 노드로 올라가서 다시 토너먼트 경기를 진행</li>
        </ul>
      </li>
      <li>루트 노드
        <ul>
          <li>패자는 1번 루트 노드에 남음</li>
          <li>승자는 전체 토너먼트의 승자로서 <code class="highlighter-rouge">0번</code> 노드로 올라가 출력</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<figure>
    
    <a href="/assets/img/file_processing/sort_merge_2_11.png"><img src="/assets/img/file_processing/sort_merge_2_11.png" alt="" /></a>
    
    <figcaption> </figcaption>
</figure>

<hr />

<h1 id="선택-트리-6">선택 트리 (6)</h1>

<ul>
  <li>합병의 진행
    <ul>
      <li>출력된 원소가 속한 런 4의 다음 원소, <br /> 즉 키값이 13인 원소를 패자트리 노드 11에 삽입</li>
      <li>패자 트리를 다시 재구성 : <br /> 토너먼트는 노드 11에서부터 루트 노드 1까지의 경로를 따라 경기를 진행</li>
    </ul>
  </li>
</ul>

        </article>
        <hr>

        
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
                
                    
                
            
        
        

        <div class="post-recent">
    <div class="pre">
        
        <p><strong>Back : </strong> <a href="/FP-Sort-Merge-(1)/"> 정렬/합병 [ Part 1 ] </a></p>
        
    </div>
    <div class="nex">

        
        <p><strong>Next : </strong> <a href="/Coding-Test-SummerCoding/"> 2018 SummerCoding - 여름방학 스타트업 인턴 프로그램 </a></p>
        
    </div>
</div>


        <h2 id="comments">Comments</h2>
        


<div id="disqus_thread"></div>
<script>
    /**
     * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */

    var disqus_config = function() {
        this.page.url = 'http://localhost:4000/FP-Sort-Merge-(2)/'; // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'http://localhost:4000/FP-Sort-Merge-(2)/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };

    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document,
            s = d.createElement('script');

        s.src = '//goodGid.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>




    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    Content
                </div>
                <ul id="content-side" class="content-ul">
                    
                    <li><a href="#comments">Comments</a></li>
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <!-- <div class="side">bbbb</div> -->
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<script src="/js/pageContent.js " charset="utf-8"></script>


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
              
        </p>
        <p class="contact">
            Contact me at: 
            <a href="https://github.com/goodGid" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>   
            <a href="https://www.facebook.com/sgy8971" title="Facebook"><i class="fa fa-facebook-official" aria-hidden="true"></i></a>   
        </p>
        <!-- <p>
            Total visits to the site<span id="busuanzi_value_site_pv"></span>the number of visitors to this site<span id="busuanzi_value_site_uv"></span>total reading of this article<span id="busuanzi_value_page_pv"></span>
        </p> -->
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
        </p>
    </div>
</footer>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <!-- <script src=" /js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
